---
// Layout and Base Components
import MainLayout from "@/layouts/MainLayout.astro";
import HeroSection from "@components/sections/landing/HeroSection.astro";
import FeaturesStatsAlt from "@components/sections/features/FeaturesStatsAlt.astro";
import FeaturesNavs from "@components/sections/features/FeaturesNavs.astro";
import QuoteFeatureSplit from "@components/sections/misc/QuoteFeatureSplit.astro"; // Import the reusable component
import { Icon } from 'astro-icon/components'; // Added import for Iconify
import PrimaryCTA from "@components/ui/buttons/PrimaryCTA.astro";
import FAQ from "@components/sections/misc/FAQ.astro"; // Import the FAQ component

// --- Helper Functions ---
// Simple SVG placeholder function
const svgPlaceholder = (width: number, height: number, text: string = "Placeholder") => {
  const escapedText = text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
  return `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 ${width} ${height}' width='${width}' height='${height}'%3E%3Crect width='100%25' height='100%25' fill='%23E5E7EB'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' fill='%236B7280' font-family='sans-serif' font-size='16'%3E${escapedText}%3C/text%3E%3C/svg%3E`; // Tailwind gray-200 background, gray-500 text
}

// --- Page Data ---
const pageTitle = "Actionable Analytics & AI Insights for Caterers | Okra Orders";

const hero = {
  // tagline: "Business Performance", // Removed tagline as HeroSection doesn't support it
  title: "Understand Your Business Better, Effortlessly",
  subTitle: "Go beyond simple order counts. Okra Orders provides a clear dashboard with key metrics, sales trends, and unique AI-powered insights to help you make smarter decisions for your catering business.",
  imgAlt: "Main Analytics Dashboard Placeholder",
  imgSrc: svgPlaceholder(900, 450, "Screenshot: Main Analytics Dashboard"),
};

const featureDashboard = {
  title: "Your Business Health, At a Glance",
  subTitle: "Log in and instantly see how your business is performing. The Okra dashboard presents key metrics like total sales and order volume, filterable by brand or individual store. Visualize daily and weekly sales trends to quickly spot patterns.",
  listItems: [
    "Centralized view of key performance indicators (KPIs).",
    "Track total sales revenue and order counts.",
    "Filter data by specific store or view brand-wide totals.",
    "Simple charts visualize daily and weekly sales trends.",
  ],
  imgSrc: svgPlaceholder(500, 600, "Screenshot: Dashboard KPIs & Charts"),
  imgAlt: "Dashboard KPIs & Charts Placeholder",
  imagePosition: "left" as const,
};

// NEW: Data structure for FeaturesNavs
const aiInsightsNav = {
  title: "Get Smarter with AI Insights", // Main title for the section
  tabs: [
    {
      heading: "Automated Daily Analysis",
      content: "Okra's AI engine reviews your sales data every day, looking for patterns and outliers.",
      svg: "mdi:chart-timeline-variant-shimmer",
      src: svgPlaceholder(500, 450, "Visual: Daily Analysis"),
      alt: "AI Daily Analysis Placeholder",
      width: 500,
      height: 450,
      first: true, // Mark this as the default tab
    },
    {
      heading: "Proactive Alerts",
      content: "Receive notifications about significant changes, potential issues like zero sales, or emerging trends.",
      svg: "mdi:bell-alert-outline",
      src: svgPlaceholder(500, 450, "Visual: Alert Example"),
      alt: "AI Alert Example Placeholder",
      width: 500,
      height: 450,
    },
    {
      heading: "Early Issue Detection",
      content: "Identify potential problems before they impact your bottom line, allowing you to act quickly.",
      svg: "mdi:magnify-scan",
      src: svgPlaceholder(500, 450, "Visual: Issue Detection"),
      alt: "AI Issue Detection Placeholder",
      width: 500,
      height: 450,
    },
    {
      heading: "Focused Attention",
      content: "The AI highlights where your attention is needed most, saving you time and effort.",
      svg: "heroicons:sparkles",
      src: svgPlaceholder(500, 450, "Visual: Focused Insight"),
      alt: "AI Focused Insight Placeholder",
      width: 500,
      height: 450,
    },
  ],
};

const finalCTA = {
  title: "Ready to See Your Business Clearly?",
  subTitle: "Start using Okra Orders and gain valuable insights from day one.",
  primaryBtn: "Start Free Trial",
  primaryBtnURL: "/signup",
  secondaryBtn: "Try Live Demo",
  secondaryBtnURL: "https://demo.okraorders.com",
};

const analyticsFaqs = {
  faqs: [
    {
      question: "What key numbers can I see immediately when I log into Okra?",
      answer: "The main dashboard gives you an instant snapshot of your business health, including total sales revenue, total number of orders, and breakdowns per location for the current day or week. Simple charts also visualize your recent sales trends."
    },
    {
      question: "How does the AI Insights feature actually help me run my business?",
      answer: "Instead of you needing to constantly dig through data, Okra's AI proactively analyzes your sales patterns daily. It automatically alerts you on the dashboard if it detects something noteworthy â€“ like a sudden drop in sales at one location, a significant increase in a specific menu item, or unusual ordering trends. This helps you spot potential issues or opportunities faster."
    },
    {
      question: "Does the dashboard show performance for just my direct Okra orders, or everything?",
      answer: "It shows everything together! Because Okra integrates ezCater orders, the sales figures, order counts, and AI insights on your dashboard reflect your total catering performance across both channels, giving you a complete and accurate picture."
    },
    {
      question: "Can I see performance for just one specific store location?",
      answer: "Yes. While the main dashboard defaults to a brand-wide view (if you have multiple stores), you can easily filter the metrics and charts to view the performance data for any individual store location."
    },
    {
      question: "Are there more detailed reports available beyond the main dashboard?",
      answer: "For V1, the primary focus is the interactive dashboard with its key metrics, charts, and AI insights. You can also view and filter your complete order history list. More advanced, customizable reporting features are planned for future development based on user feedback."
    },
    {
      question: "How accurate are the AI insights? Can I trust them?",
      answer: "The AI analyzes the factual sales and order data within your Okra account. It's designed to spot statistical deviations and significant changes based on historical patterns. While it provides valuable flags and potential areas to investigate, it's always best practice to use these insights as a starting point for your own deeper analysis or verification."
    }
  ]
};

---

<MainLayout title={pageTitle}>

  <!-- Page Hero Section -->
  <div class="bg-gradient-to-b from-blue-50 to-white pt-16 md:pt-24 pb-8 md:pb-12"> <!-- Using Blue accent -->
      <HeroSection
        title={hero.title}
        subTitle={hero.subTitle}
        primaryBtn={undefined}
        primaryBtnURL={undefined}
        secondaryBtn={undefined}
        secondaryBtnURL={undefined}
      >
        <Fragment slot="image">
          <div class="mt-8 px-6">
             <img src={hero.imgSrc} alt={hero.imgAlt} class="h-72 w-full max-w-3xl mx-auto rounded-lg shadow-md object-cover"/>
          </div>
        </Fragment>
      </HeroSection>
  </div>

  <!-- Feature Detail 1: Central Dashboard -->
  <section class="py-16 md:py-24 bg-white rounded-xl">
    <FeaturesStatsAlt
        title={featureDashboard.title}
        subTitle={featureDashboard.subTitle}
        benefits={featureDashboard.listItems}
        imgSrc={featureDashboard.imgSrc}
        imgAlt={featureDashboard.imgAlt}
        imgWidth={500}
        imgHeight={600}
        imagePosition={featureDashboard.imagePosition}
     />
  </section>

  <!-- Feature Detail 2: AI-Powered Insights (Now using FeaturesNavs) -->
  <section class="py-16 md:py-24">
    <FeaturesNavs
        title={aiInsightsNav.title}
        tabs={aiInsightsNav.tabs}
        instanceId="ai-insights"
    />
  </section>

  <!-- Go Beyond Reports Section -->
  <QuoteFeatureSplit
      quoteContent="The AI insights have actually flagged things we wouldn't have noticed until much later, like a sudden drop-off in lunch orders at one location, allowing us to investigate quicker."
      quoteAttribution="- Data-Focused Catering Manager"
      featureIconName="heroicons:sparkles"
      featureBadgeText="Proactive Insights"
      featureTitle="Don't Just Track Sales, Understand Them"
      featureDescription="Standard sales reports show you what happened. Okra's AI Insights help you understand why and what might happen next. By automatically analyzing your daily sales data for significant shifts or anomalies (like a specific menu item suddenly surging or a location going quiet), Okra gives you early warnings and actionable insights that simple charts often miss."
      layoutDirection="quote-left"
  >
      <Fragment slot="feature-graphic">
          <!-- Mockup graphic showing an example AI Insight alert popping up -->
      </Fragment>
  </QuoteFeatureSplit>

  <!-- Feature Detail 3: Unified Reporting (Custom Section) -->
  <section class="py-16 md:py-24 bg-white rounded-xl">
      <div class="container mx-auto px-6 text-center">
        <h2 class="text-3xl font-bold text-neutral-800 mb-4">The Complete Picture: Okra + ezCater</h2>
        <p class="text-lg text-gray-600 mb-10 max-w-2xl mx-auto">
           Because Okra integrates your ezCater orders, your dashboard metrics and insights reflect your *entire* catering operation. Finally get a true, unified view of your total sales performance across all your channels.
        </p>
        <!-- Simple graphic: Okra Logo + ezCater Logo -> Graph Icon -->
         <div class="flex justify-center items-center space-x-4 md:space-x-6 opacity-80">
            <div class="p-2 rounded bg-white shadow-md text-center">
                <span class="text-lg font-bold text-neutral-800">Okra<span class="text-primary">Orders</span></span>
            </div>
            <span class="text-2xl font-bold text-gray-400">+</span>
            <div class="p-2 rounded bg-white shadow-md">
                <img src={svgPlaceholder(100, 40, "ezCater Logo")} alt="ezCater Logo Placeholder" class="h-8 md:h-10" />
            </div>
            <Icon name="heroicons:arrow-long-right" class="w-8 h-8 text-gray-400 flex-shrink-0" />
            <Icon name="heroicons:chart-pie" class="w-14 h-14 text-primary flex-shrink-0" />
         </div>
      </div>
  </section>

  <!-- Future Potential Section (Custom Simple Section) -->
  <section class="py-16 md:py-24">
      <div class="container mx-auto px-6 text-center">
           <h2 class="text-3xl font-bold text-neutral-800 mb-4">Built for Deeper Insights</h2>
          <p class="text-lg text-gray-600 max-w-2xl mx-auto">
             Today's dashboard gives you essential visibility. Okra's platform is built on a solid data foundation, ready to deliver even more advanced reporting and analytics features in the future to help you grow your business strategically.
          </p>
      </div>
  </section>

  <!-- CTA Section (Custom Section) -->
  <section class="bg-gradient-to-r from-primary to-green-700 text-white py-16 rounded-xl">
      <div class="container mx-auto px-6 text-center">
          <h2 class="text-3xl font-bold mb-4">{finalCTA.title}</h2>
          <p class="text-lg mb-8 opacity-90 max-w-2xl mx-auto">{finalCTA.subTitle}</p>
          <div class="flex flex-col sm:flex-row justify-center items-center gap-4">
              <PrimaryCTA title={finalCTA.primaryBtn} url={finalCTA.primaryBtnURL} />
              <a href={finalCTA.secondaryBtnURL} target="_blank" rel="noopener noreferrer" class="inline-block border border-white text-white px-6 py-2.5 rounded-md text-base font-semibold hover:bg-white hover:text-primary transition duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-primary focus:ring-white">
                 {finalCTA.secondaryBtn}
              </a>
          </div>
      </div>
  </section>

  <!-- FAQ Section -->
  <section class="py-16 md:py-24 bg-neutral-50 dark:bg-neutral-900">
    <FAQ title="Your Analytics Questions Answered" faqs={analyticsFaqs} />
  </section>

</MainLayout> 

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  document.addEventListener("DOMContentLoaded", () => {
    // --- Section Animations on Scroll ---
    gsap.utils.toArray<HTMLElement>('section').forEach(section => {
      gsap.from(section, {
        scrollTrigger: {
          trigger: section,
          start: "top 85%",
          end: "bottom 15%", 
          toggleActions: "play none none reverse",
          // markers: true, 
        },
        opacity: 0,
        y: 30,
        duration: 0.6,
        ease: "power1.out",
      });
    });
  });
</script> 