---
// Layout and Base Components
import MainLayout from "@/layouts/MainLayout.astro";
// import HeroSection from "@components/sections/landing/HeroSection.astro";
import HeroImage from "@components/sections/landing/HeroImage.astro"; // Use HeroImage
import FeaturesStatsAlt from "@components/sections/features/FeaturesStatsAlt.astro";
import FeaturesNavs from "@components/sections/features/FeaturesNavs.astro"; // Restoring import, FeaturesNavs might be used elsewhere or this change might be reverted.
import QuoteFeatureSplit from "@components/sections/misc/QuoteFeatureSplit.astro"; // Import the reusable component
import { Icon } from 'astro-icon/components'; // Added import for Iconify
import PrimaryCTA from "@components/ui/buttons/PrimaryCTA.astro";
import FAQ from "@components/sections/misc/FAQ.astro"; // Import the FAQ component
import CTASection from "@components/sections/misc/CTASection.astro"; // Added import
import IconListSection from "@components/sections/features/IconListSection.astro"; // Import IconListSection
import ctaBgImage from "@/images/layered-waves-haikei.svg"; // Import the background SVG
import insightsImage from "@/images/insights.png"; // Uncommented: Import the new image
import dashboardImage from "@/images/dashboard.png"; // Import the dashboard image
import heroBgImage from "@/images/stacked-waves-haikei.svg"; // Import a background for hero
import dashboardFullImage from "@/images/dashboard-full.png"; // Import the new dashboard-full.png image

// --- Helper Functions ---
// Uncommented: Simple SVG placeholder function
const svgPlaceholder = (width: number, height: number, text: string = "Placeholder") => {
  const escapedText = text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
  return `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 ${width} ${height}' width='${width}' height='${height}'%3E%3Crect width='100%25' height='100%25' fill='%23E5E7EB'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' fill='%236B7280' font-family='sans-serif' font-size='16'%3E${escapedText}%3C/text%3E%3C/svg%3E`; // Tailwind gray-200 background, gray-500 text
}

// --- Page Data ---
const pageTitle = "Actionable Analytics & AI Insights for Caterers | Okra Orders";

const hero = {
  // tagline: "Business Performance", // HeroImage doesn't use tagline directly in this config
  title: "Understand Your Business Better, Effortlessly",
  subTitle: "Go beyond simple order counts. Okra Orders provides a clear dashboard with key metrics, sales trends, and unique AI-powered insights to help you make smarter decisions for your catering business.",
  imgAlt: "Okra Orders Analytics Dashboard showing charts and key metrics",
  imgSrc: dashboardImage,
  backgroundImageURL: heroBgImage.src
};

const featureDashboard = {
  title: "Your Business Health, At a Glance",
  subTitle: "Log in and instantly see how your business is performing. The Okra dashboard presents key metrics like total sales and order volume, filterable by brand or individual store. Visualize daily and weekly sales trends to quickly spot patterns.",
  listItems: [
    "Centralized view of key performance indicators (KPIs).",
    "Track total sales revenue and order counts.",
    "Filter data by specific store or view brand-wide totals.",
    "Simple charts visualize daily and weekly sales trends.",
  ],
  imgSrc: dashboardFullImage.src, // Updated to use dashboardFullImage.src
  imgAlt: "Full view of the Okra Orders analytics dashboard", // Updated alt text
  imagePosition: "left" as const,
};

// RESTRUCTURED: Data for the AI Insights section, to be used with FeaturesStatsAlt
const aiInsightsSection = {
  title: "Get Smarter with AI Insights",
  subTitle: "Automated Daily Analysis: Okra's AI engine reviews your sales data every day, looking for patterns and outliers.", // Content from the first tab of the old structure
  listItems: [
    "Easily spot significant changes, potential issues like zero sales, or emerging trends.",
    "Identify potential problems before they impact your bottom line, allowing you to act quickly.",
    "The AI highlights where your attention is needed most, saving you time and effort.",
  ],
  imgSrc: insightsImage.src, // Use .src property for the image path - Assuming insightsImage should still be defined somewhere or removed if not used
  imgAlt: "AI Powered Insights Illustration",
  imagePosition: "right" as const,
};

// Config for the QuoteFeatureSplit (Updated Content)
const quoteProactive = {
  quoteContent: "Standard sales reports are fine, but often lag. Getting an automated heads-up from the AI if, say, lunch orders suddenly tank at one location, or a specific item starts trending unexpectedly – that allows us to react faster instead of waiting for month-end analysis.", // Updated quote
  quoteAttribution: "- Maciej, Okra Orders CTO (Explaining AI Insight Value)", // Updated attribution
  featureIconName: "heroicons:sparkles",
  featureBadgeText: "Proactive Insights",
  featureTitle: "Don't Just Track Sales, Understand Them",
  featureDescription: "Standard sales reports show you what happened. Okra's AI Insights help you understand why and what might happen next. By automatically analyzing your daily sales data for significant shifts or anomalies (like a specific menu item suddenly surging or a location going quiet), Okra gives you early warnings and actionable insights that simple charts often miss.",
  layoutDirection: "quote-left" as const,
};

// NEW Config for Unified Reporting section using IconListSection
const unifiedReportingWithIcons = {
  title: "The Complete Picture: Okra + ezCater",
  subTitle: "Because Okra integrates your ezCater orders, your dashboard metrics and insights reflect your *entire* catering operation. Finally get a true, unified view of your total sales performance across all your channels.",
  items: [
    { iconName: "heroicons:building-storefront", text: "Direct Okra Orders" },
    { iconName: "heroicons:link", text: "Synced ezCater Orders" },
    { iconName: "heroicons:chart-pie", text: "Total Performance Insights" },
  ]
};

// Config for Future Potential section (remains custom)
const futurePotential = {
    title: "Built for Deeper Insights",
    subTitle: "Today's dashboard gives you essential visibility. Okra's platform is built on a solid data foundation, ready to deliver even more advanced reporting and analytics features in the future to help you grow your business strategically.",
};

const finalCTA = {
  title: "Ready to See Your Business Clearly?",
  subTitle: "Start using Okra Orders and gain valuable insights from day one.",
  primaryBtn: "Start Free Trial",
  primaryBtnURL: "/signup",
  secondaryBtn: "Try Live Demo",
  secondaryBtnURL: "https://demo.okraorders.com",
  bgImageURL: ctaBgImage.src, // Add background image
  textColor: "white" as const // Keep text white
};

const analyticsFaqs = {
  title: "Your Analytics Questions Answered", // Add title
  faqs: [
    {
      question: "What key numbers can I see immediately when I log into Okra?",
      answer: "The main dashboard gives you an instant snapshot of your business health, including total sales revenue, total number of orders, and breakdowns per location for the current day or week. Simple charts also visualize your recent sales trends."
    },
    {
      question: "How does the AI Insights feature actually help me run my business?",
      answer: "Instead of you needing to constantly dig through data, Okra's AI proactively analyzes your sales patterns daily. It automatically alerts you on the dashboard if it detects something noteworthy – like a sudden drop in sales at one location, a significant increase in a specific menu item, or unusual ordering trends. This helps you spot potential issues or opportunities faster."
    },
    {
      question: "Does the dashboard show performance for just my direct Okra orders, or everything?",
      answer: "It shows everything together! Because Okra integrates ezCater orders, the sales figures, order counts, and AI insights on your dashboard reflect your total catering performance across both channels, giving you a complete and accurate picture."
    },
    {
      question: "Can I see performance for just one specific store location?",
      answer: "Yes. While the main dashboard defaults to a brand-wide view (if you have multiple stores), you can easily filter the metrics and charts to view the performance data for any individual store location."
    },
    {
      question: "Are there more detailed reports available beyond the main dashboard?",
      answer: "For V1, the primary focus is the interactive dashboard with its key metrics, charts, and AI insights. You can also view and filter your complete order history list. More advanced, customizable reporting features are planned for future development based on user feedback."
    },
    {
      question: "How accurate are the AI insights? Can I trust them?",
      answer: "The AI analyzes the factual sales and order data within your Okra account. It's designed to spot statistical deviations and significant changes based on historical patterns. While it provides valuable flags and potential areas to investigate, it's always best practice to use these insights as a starting point for your own deeper analysis or verification."
    }
  ]
};

---

<MainLayout title={pageTitle}>

  <!-- Page Hero Section -->
  <div class="mb-12"> {/* Adjusted styling to match online-ordering.astro hero container */}
      <HeroImage
        title={hero.title}
        subTitle={hero.subTitle}
        primaryBtn={undefined}
        primaryBtnURL={undefined}
        secondaryBtn={undefined}
        secondaryBtnURL={undefined}
        src={hero.imgSrc}
        alt={hero.imgAlt}
        imgWidth={800}
        withReview={false}
        imageScale="scale-90"
        rightOffset="right-[-11rem]"
        minSectionHeight="min-h-[600px]"
        backgroundImageURL={hero.backgroundImageURL}
      /> {/* Comments moved outside or removed for props like imgWidth, withReview etc. */}
  </div>

  <!-- Feature Detail 1: Central Dashboard -->
  <section class="py-16 md:py-24 bg-white rounded-xl">
    <FeaturesStatsAlt
        title={featureDashboard.title}
        subTitle={featureDashboard.subTitle}
        benefits={featureDashboard.listItems}
        imgSrc={featureDashboard.imgSrc}
        imgAlt={featureDashboard.imgAlt}
        imgWidth={500}
        imgHeight={600}
        imagePosition={featureDashboard.imagePosition}
     />
  </section>

  <!-- Feature Detail 2: AI-Powered Insights (Now using FeaturesStatsAlt with media slot) -->
  <section class="py-16 md:py-24">
    <FeaturesStatsAlt
        title={aiInsightsSection.title}
        subTitle={aiInsightsSection.subTitle}
        benefits={aiInsightsSection.listItems}
        imagePosition={aiInsightsSection.imagePosition}
    >
        <Fragment slot="media">
            <img 
                src={aiInsightsSection.imgSrc} 
                alt={aiInsightsSection.imgAlt} 
                class="rounded-xl w-full h-auto"
            />
        </Fragment>
    </FeaturesStatsAlt>
  </section>

  <!-- Go Beyond Reports Section -->
  <QuoteFeatureSplit
      quoteContent={quoteProactive.quoteContent}
      quoteAttribution={quoteProactive.quoteAttribution}
      featureIconName={quoteProactive.featureIconName}
      featureBadgeText={quoteProactive.featureBadgeText}
      featureTitle={quoteProactive.featureTitle}
      featureDescription={quoteProactive.featureDescription}
      layoutDirection={quoteProactive.layoutDirection}
  >
      <Fragment slot="feature-graphic">
          <!-- Mockup graphic showing an example AI Insight alert popping up -->
      </Fragment>
  </QuoteFeatureSplit>

  <!-- Feature Detail 3: Unified Reporting (Now using IconListSection) -->
  <section class="py-16 md:py-24 bg-white rounded-2xl my-12">
    <IconListSection 
        title={unifiedReportingWithIcons.title}
        subTitle={unifiedReportingWithIcons.subTitle}
        items={unifiedReportingWithIcons.items}
    />
  </section>

  <!-- Future Potential Section (Custom Simple Section) -->
  <section class="py-16 md:py-24">
      <div class="container mx-auto px-6 text-center">
           <h2 class="text-3xl font-bold text-neutral-800 mb-4">{futurePotential.title}</h2>
          <p class="text-lg text-gray-600 max-w-2xl mx-auto">
             {futurePotential.subTitle}
          </p>
      </div>
  </section>

  <!-- CTA Section (Using CTASection Component) -->
  <CTASection
      title={finalCTA.title}
      subTitle={finalCTA.subTitle}
      primaryBtn={finalCTA.primaryBtn}
      primaryBtnURL={finalCTA.primaryBtnURL}
      secondaryBtn={finalCTA.secondaryBtn}
      secondaryBtnURL={finalCTA.secondaryBtnURL}
      bgImageURL={finalCTA.bgImageURL}
      textColor={finalCTA.textColor}
  />

  <!-- FAQ Section -->
  <section class="py-16 md:py-24 bg-neutral-50 dark:bg-neutral-900 my-12 rounded-2xl">
    <FAQ title={analyticsFaqs.title} faqs={analyticsFaqs} />
  </section>

</MainLayout> 

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  document.addEventListener("DOMContentLoaded", () => {
    // --- Section Animations on Scroll ---
    gsap.utils.toArray<HTMLElement>('section').forEach(section => {
      gsap.from(section, {
        scrollTrigger: {
          trigger: section,
          start: "top 85%",
          end: "bottom 15%", 
          toggleActions: "play none none reverse",
          // markers: true, 
        },
        opacity: 0,
        y: 30,
        duration: 0.6,
        ease: "power1.out",
      });
    });
  });
</script> 