---
// Layout and Base Components
import MainLayout from "@/layouts/MainLayout.astro";
import HeroSection from "@components/sections/landing/HeroSection.astro";
import FeaturesStatsAlt from "@components/sections/features/FeaturesStatsAlt.astro";
import { Icon } from 'astro-icon/components';
import PrimaryCTA from "@components/ui/buttons/PrimaryCTA.astro";
import FAQ from "@components/sections/misc/FAQ.astro";
import QuoteFeatureSplit from "@components/sections/misc/QuoteFeatureSplit.astro";

// --- Helper Functions ---
// Simple SVG placeholder function (replicated for self-containment)
const svgPlaceholder = (width: number, height: number, text: string = "Placeholder") => {
  const escapedText = text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
  return `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 ${width} ${height}' width='${width}' height='${height}'%3E%3Crect width='100%25' height='100%25' fill='%23E5E7EB'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' fill='%236B7280' font-family='sans-serif' font-size='16'%3E${escapedText}%3C/text%3E%3C/svg%3E`; // Tailwind gray-200 background, gray-500 text
}

// --- Page Data ---
const pageTitle = "Streamlined Catering Operations & Order Management | Okra Orders";

const hero = {
  title: "Manage Orders, Payments, and Fulfillment – All in One Place",
  subTitle: "Stop chasing orders across different platforms. Okra Orders centralizes your entire catering operation, from viewing incoming requests to managing payments and optimizing kitchen workflow.",
  imgAlt: "Order Dashboard Placeholder",
  imgSrc: svgPlaceholder(900, 450, "Screenshot: Order Dashboard"), // Wider placeholder
};

const featureUnifiedView = {
  title: "See Everything at a Glance",
  subTitle: "Get a complete picture of your daily workload instantly. Okra's central dashboard displays all your orders – whether placed directly through your Okra storefront or synced from <strong>ezCater</strong>. Filter by date, status, store, or source to plan your prep efficiently.",
  listItems: [
    "Single view for Okra and ezCater orders.",
    "Powerful filtering and search capabilities.",
    "Clear status indicators for each order.",
    "Simplifies daily kitchen planning and preparation.",
  ],
  imgSrc: svgPlaceholder(500, 600, "Screenshot: Unified Order List"),
  imgAlt: "Unified Order List Placeholder (Okra + ezCater)",
  imagePosition: "left" as const,
};

const featureOrderEditing = {
  title: "Adapt to Changes Instantly",
  subTitle: "Customer needs to add drinks last minute? Increase the headcount? No problem. Okra allows your admin team to easily edit *any* detail of an existing order – items, quantities, options, delivery info – right up until it's time for fulfillment. Use the \"Open Food\" feature to add completely custom items on the fly.",
  listItems: [
    "Modify quantities, items, and customizations easily.",
    "Update delivery addresses or pickup times.",
    "Add custom \"Open Food\" items with unique pricing.",
    "Flexibility accommodates last-minute customer requests.",
  ],
  imgSrc: svgPlaceholder(500, 600, "GIF: Admin Editing Order Details"),
  imgAlt: "Admin Editing Order Details Placeholder",
  imagePosition: "right" as const,
};

const featureFulfillment = {
  title: "Optimize Your Kitchen Workflow",
  subTitle: "Manage your kitchen capacity and delivery logistics effectively. Okra supports ghost kitchen operations seamlessly and allows admins to easily transfer orders between locations to balance workload or accommodate driver availability – all without impacting the customer.",
  listItems: [
    "Designate specific locations as hidden Ghost Kitchens.",
    "System intelligently assigns orders based on proximity (delivery).",
    "Manually transfer orders between any stores within your brand.",
    "Improve efficiency and manage kitchen load effectively.",
  ],
  imgSrc: svgPlaceholder(500, 600, "Visual: Order Transfer / Ghost Kitchen Flow"),
  imgAlt: "Order Transfer / Ghost Kitchen Flow Placeholder",
  imagePosition: "left" as const,
};

const finalCTA = {
  title: "Ready to Streamline Your Day-to-Day Operations?",
  subTitle: "Discover how Okra Orders brings clarity and efficiency to managing your catering orders and fulfillment.",
  primaryBtn: "Start Free Trial",
  primaryBtnURL: "/signup",
  secondaryBtn: "Try Live Demo",
  secondaryBtnURL: "https://demo.okraorders.com",
};

const operationsFaqs = {
  faqs: [
    {
      question: "How do we manage daily prep if orders come from both Okra and ezCater?",
      answer: "Okra provides a unified order dashboard where you see all incoming orders, clearly marked by source (Okra or ezCater). This gives your kitchen team a single, consolidated view for planning daily production and fulfillment without needing to check multiple systems."
    },
    {
      question: "Customers often call to change order details (like headcount or adding an item) after placing an order. How does Okra handle edits?",
      answer: "Okra gives your admin team full flexibility. You can open any existing order (until it's processed for payment/fulfillment) and modify quantities, add/remove items, update delivery details, apply discounts, or even add completely custom \"Open Food\" items with specific pricing to accommodate any request."
    },
    {
      question: "We have a central kitchen (ghost kitchen) that fulfills orders for some areas. How does that work in Okra without confusing customers?",
      answer: "Okra handles this seamlessly. You designate your ghost kitchens internally. For delivery orders, the system automatically assigns the order to the closest capable kitchen (which could be a ghost kitchen), but the customer only interacts with your main brand presence. Admins can also manually transfer orders between any locations (ghost or regular) to manage kitchen load or driver logistics."
    },
    {
      question: "How do we know if a customer's payment actually went through, especially since it's charged later?",
      answer: "The order dashboard clearly displays the payment status for each order (e.g., Pending, Paid, Failed). You can set rules for when automatic charging occurs (e.g., day of delivery). If an automated charge fails, notifications can be sent to your team and the customer. Admins can also manually trigger payment attempts."
    },
    {
      question: "What happens if a customer's primary card fails? Do we lose the order?",
      answer: "Not necessarily. If a customer has saved multiple payment methods, Okra can be configured to automatically try charging a secondary card if the primary one fails. This increases the chance of successful payment capture without manual intervention."
    },
    {
      question: "Can different staff members have different levels of access (e.g., only viewing orders vs. editing menus)?",
      answer: "Yes. Okra includes role-based access control. You can assign roles like Store Manager or Staff, limiting their view and actions to only what's necessary for their job, which helps prevent accidental errors and maintains control."
    },
    {
      question: "How are we notified about new orders? Can it become overwhelming?",
      answer: "You have control. Okra can send email notifications to designated store managers or staff for new orders. However, you can configure the frequency or disable these if the volume is too high, relying instead on the central order dashboard for management."
    }
  ]
};

---

<MainLayout title={pageTitle}>

  <!-- Page Hero Section -->
  <div class="bg-gradient-to-b from-green-50 to-white pt-16 md:pt-24 pb-8 md:pb-12"> <!-- Green accent -->
      <HeroSection
        title={hero.title}
        subTitle={hero.subTitle}
        primaryBtn={undefined}
        primaryBtnURL={undefined}
        secondaryBtn={undefined}
        secondaryBtnURL={undefined}
      >
        <Fragment slot="image">
          <div class="mt-8 px-6">
             <img src={hero.imgSrc} alt={hero.imgAlt} class="h-72 w-full max-w-3xl mx-auto rounded-lg shadow-md object-cover"/>
          </div>
        </Fragment>
      </HeroSection>
  </div>

  <!-- Feature Detail 1: Unified Order View -->
  <section class="py-16 md:py-24 bg-white rounded-xl">
    <FeaturesStatsAlt
        title={featureUnifiedView.title}
        subTitle={featureUnifiedView.subTitle}
        benefits={featureUnifiedView.listItems}
        imgSrc={featureUnifiedView.imgSrc}
        imgAlt={featureUnifiedView.imgAlt}
        imgWidth={500}
        imgHeight={600}
        imagePosition={featureUnifiedView.imagePosition}
     />
  </section>

  <!-- Gain Operational Clarity Section -->
  <QuoteFeatureSplit
      quoteContent="Having ezCater orders appear automatically alongside our direct ones in Okra finally gives us a true picture of the day's workload in one spot. It's simplified our morning prep routine significantly."
      quoteAttribution="- Catering Operations Manager"
      featureIconName="heroicons:clipboard-document-list"
      featureBadgeText="Operational Clarity"
      featureTitle="Know Exactly What Needs Doing, Without the Guesswork"
      featureDescription="Start your day with confidence. Seeing all your direct and ezCater orders consolidated in one clear dashboard means no more switching tabs or worrying about missed requests. Plan your kitchen prep accurately, manage fulfillment smoothly, and track the status of every single order from pending to paid, all in real-time."
      layoutDirection="quote-left"
  >
      <Fragment slot="feature-graphic">
          <!-- Screenshot focusing on the Order Dashboard grid with clear status indicators -->
      </Fragment>
  </QuoteFeatureSplit>

  <!-- Feature Detail 2: Flexible Order Editing -->
  <section class="py-16 md:py-24">
    <FeaturesStatsAlt
        title={featureOrderEditing.title}
        subTitle={featureOrderEditing.subTitle}
        benefits={featureOrderEditing.listItems}
        imgSrc={featureOrderEditing.imgSrc}
        imgAlt={featureOrderEditing.imgAlt}
        imgWidth={500}
        imgHeight={600}
        imagePosition={featureOrderEditing.imagePosition}
    />
  </section>

  <!-- Feature Detail 3: Fulfillment Optimization -->
  <section class="py-16 md:py-24 bg-white rounded-xl">
     <FeaturesStatsAlt
        title={featureFulfillment.title}
        subTitle={featureFulfillment.subTitle}
        benefits={featureFulfillment.listItems}
        imgSrc={featureFulfillment.imgSrc}
        imgAlt={featureFulfillment.imgAlt}
        imgWidth={500}
        imgHeight={600}
        imagePosition={featureFulfillment.imagePosition}
    />
  </section>

  <!-- Feature Detail 4: Payment Management (Custom Section) -->
  <section class="py-16 md:py-24">
      <div class="container mx-auto px-6 text-center">
        <h2 class="text-3xl font-bold text-neutral-800 mb-4">Streamlined & Reliable Payments</h2>
        <p class="text-lg text-gray-600 mb-10 max-w-2xl mx-auto">
           Take the stress out of getting paid. Okra handles payment capture securely based on your rules, notifies you of issues, and provides tools to manage payments effectively right within the app.
        </p>
        <div class="flex flex-col sm:flex-row justify-center items-start gap-y-8 sm:gap-x-12 md:gap-x-16 text-gray-700">
            <div class="text-center max-w-xs mx-auto sm:mx-0">
                 <Icon name="heroicons:credit-card" class="w-12 h-12 mx-auto text-primary mb-3" />
                <h3 class="font-semibold text-neutral-700 mb-1">Automated Capture</h3>
                <p class="text-sm text-gray-600">Set rules to automatically charge saved customer tokens (e.g., 1 hour before fulfillment).</p>
            </div>
            <div class="text-center max-w-xs mx-auto sm:mx-0">
                 <Icon name="heroicons:clipboard-document-check" class="w-12 h-12 mx-auto text-primary mb-3" />
                <h3 class="font-semibold text-neutral-700 mb-1">Clear Status Tracking</h3>
                <p class="text-sm text-gray-600">Easily see payment status (Pending, Paid, Failed) on the order dashboard.</p>
            </div>
            <div class="text-center max-w-xs mx-auto sm:mx-0">
                 <Icon name="heroicons:exclamation-triangle" class="w-12 h-12 mx-auto text-primary mb-3" />
                <h3 class="font-semibold text-neutral-700 mb-1">Proactive Error Handling</h3>
                <p class="text-sm text-gray-600">Get notified automatically if a payment fails, with options for retries on backup cards.</p>
            </div>
        </div>
        <p class="mt-8 text-sm text-gray-500 italic">(In-app Void & Refund capabilities coming soon!)</p>
      </div>
  </section>

  <!-- CTA Section (Custom Section) -->
  <section class="bg-gradient-to-r from-primary to-green-700 text-white py-16 rounded-xl">
      <div class="container mx-auto px-6 text-center">
          <h2 class="text-3xl font-bold mb-4">{finalCTA.title}</h2>
          <p class="text-lg mb-8 opacity-90 max-w-2xl mx-auto">{finalCTA.subTitle}</p>
          <div class="flex flex-col sm:flex-row justify-center items-center gap-4">
              <PrimaryCTA title={finalCTA.primaryBtn} url={finalCTA.primaryBtnURL} />
               <a href={finalCTA.secondaryBtnURL} target="_blank" rel="noopener noreferrer" class="inline-block border border-white text-white px-6 py-2.5 rounded-md text-base font-semibold hover:bg-white hover:text-primary transition duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-primary focus:ring-white">
                 {finalCTA.secondaryBtn}
              </a>
          </div>
      </div>
  </section>

  <!-- FAQ Section -->
  <section class="py-16 md:py-24 bg-neutral-50 dark:bg-neutral-900">
    <FAQ title="Your Operational Questions Answered" faqs={operationsFaqs} />
  </section>

</MainLayout>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  document.addEventListener("DOMContentLoaded", () => {
    // --- Section Animations on Scroll ---
    gsap.utils.toArray<HTMLElement>('section').forEach(section => {
      gsap.from(section, {
        scrollTrigger: {
          trigger: section,
          start: "top 85%",
          end: "bottom 15%", 
          toggleActions: "play none none reverse",
          // markers: true, 
        },
        opacity: 0,
        y: 30,
        duration: 0.6,
        ease: "power1.out",
      });
    });
  });
</script> 